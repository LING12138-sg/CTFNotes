#### BUUCTFzips——时间戳加密+掩码爆破

* 下载文件是一个压缩包`222.zip`，打开发现里面也是一个压缩包`111.zip`，再打开提示需要密码，因为没有给出密码的提示，所以要么是伪加密，要么是弱口令
* 尝试用`ZipCracker`，发现不是伪加密，于是用`ARCHPR`爆破密码，成功
* 打开该压缩包发现里面还是一个压缩包`flag.zip`，另外有一个`setup.sh`文件，但是打不开，显示`数据文件头部损坏`，那可以看看拖入010头部，先打开压缩包发现又需要密码，这里不用想密码肯定跟这个`.sh`文件有关
* 但是这个东西打不开，头上有个`*`号，将`111.zip`拖入010看看，找到`setup.sh`文件所在位置，发现它是伪加密（`50 4B 01 02`后面是`09`），将`09`改为`08`就可以打开`.sh`文件了
* 用010打开是`zip -e --password='python -c "print(__import__('time').time())"' flag.zip flag`，这里`zip`的意思是对zip文件进行操作，`-e`是对其进行加密的意思，`--password=`表示加密密码为后面的东西，`print(__import__('time').time())`，这里意思是打印出当前的时间戳，然后用它作为密码对`flag.zip`进行加密
* 于是我们就可以查看这个`flag.zip`最后的修改时间，是`2019-5-17 16:10`，将它转换为时间戳是`1558080600`，但这个并不是密码，但是差不多就在这附近了
* 于是我们可以用掩码爆破，因为<font color=red>python2的时间戳是保留到小数点后两位，而python3的时间戳最多保留到后七位</font>，所以我们先从简单的开始
* 在设置掩码为`ARCHPR`中设置掩码为`15????????.??`，选中所有数字，然后从`1500000000.00`开始，到`1599999999.99`结束，等的时间可能有点长，但是最终也是爆破出了密码
* 解开`flag.zip`，得到flag





<font color=blue>总结：</font>

* 通过这题我首先，如果文件带`*`号就是加密了，如果提示文件头部损坏可能就是文件头被改了点东西，此外判断伪加密不能完全依赖于工具，如果压缩包里还有压缩包，那还得自己看是不是伪加密
* 学到了时间戳加密，以及解密网站http://shijianchuo.wiicha.com/
* 了解了掩码爆破